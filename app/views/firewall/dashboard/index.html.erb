<% if !@message.nil? %>
<div class="alert fade in">
  <button type="button" class="close" data-dismiss="alert">Ã—</button>
  <strong>Message: </strong><%= @message %>
</div>
<% end %>

<div class="row">
  <div class="col-lg-10 col-lg-push-1">

    <legend>Rules</legend>
    <pre><%= Firewall::IptablesHelper.show_rules() %></pre>

    <button type="button" class="btn btn-default">Activate blacklisting</button>
    <p class="help-block">Blacklisting is currently active</p>

    <form action="<%= url_for :controller => 'rules', :action => 'create' %>" method="post">
      <fieldset>
        <legend>Add rule</legend>
        <div class="form-group">
          <label for="newRule">New rule</label>
          <input type="text" name="rule" class="form-control" id="newRule" placeholder="New iptables rule without iptables command">
        </div>
        <button type="submit" class="btn btn-default">Add rule</button>
      </fieldset>
    </form>

    <br>

    <div class="well">
      <legend>Danger Area</legend>

      <form action="<%= url_for :controller => 'rules', :action => 'reset' %>">
        <fieldset>
          <button type="button" id="resetButton" class="btn btn-danger">Reset firewall rules</button>
        </fieldset>
    </form>
    </div>

  </div>
</div>

<script type="text/javascript">
  $(function() {
    $('#resetButton').click(function() {

      if(confirm("Are you sure to reset all config?")){
        $.ajax({
          url: $(this).closest('form').attr('action'),
          method: 'delete',
          complete: function() {
            window.location.href = "<%= url_for :controller => 'dashboard', :action => 'index' %>"
          }
        });

      }

    });
  });

</script>
